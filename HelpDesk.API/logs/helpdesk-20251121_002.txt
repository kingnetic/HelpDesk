2025-11-21 16:13:58.762 -06:00 [INF] Starting HelpDesk API
2025-11-21 16:13:59.308 -06:00 [INF] User profile is available. Using 'C:\Users\marvin.gonzalez\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-21 16:14:00.190 -06:00 [ERR] An error occurred while seeding the database
System.InvalidOperationException: An error was generated for warning 'Microsoft.EntityFrameworkCore.Migrations.PendingModelChangesWarning': The model for context 'HelpDeskDbContext' has pending changes. Add a new migration before updating the database. See https://aka.ms/efcore-docs-pending-changes. This exception can be suppressed or logged by passing event ID 'RelationalEventId.PendingModelChangesWarning' to the 'ConfigureWarnings' method in 'DbContext.OnConfiguring' or 'AddDbContext'.
   at Microsoft.EntityFrameworkCore.Diagnostics.EventDefinition`1.Log[TLoggerCategory](IDiagnosticsLogger`1 logger, TParam arg)
   at Microsoft.EntityFrameworkCore.Diagnostics.RelationalLoggerExtensions.PendingModelChangesWarning(IDiagnosticsLogger`1 diagnostics, Type contextType)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.ValidateMigrations(Boolean useTransaction, String targetMigration)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at HelpDesk.Infrastructure.Persistence.DbSeeder.SeedAsync(IServiceProvider services) in D:\REPOSITORY\HelpDesk\HelpDesk.Infrastructure\Persistence\DbSeeder.cs:line 21
   at Program.<Main>$(String[] args) in D:\REPOSITORY\HelpDesk\HelpDesk.API\Program.cs:line 84
2025-11-21 16:14:00.216 -06:00 [INF] HelpDesk API started successfully
2025-11-21 16:14:00.297 -06:00 [ERR] Hosting failed to start
System.IO.IOException: Failed to bind to address http://127.0.0.1:5021: address already in use.
 ---> Microsoft.AspNetCore.Connections.AddressInUseException: Solo se permite un uso de cada dirección de socket (protocolo/dirección de red/puerto)
 ---> System.Net.Sockets.SocketException (10048): Solo se permite un uso de cada dirección de socket (protocolo/dirección de red/puerto)
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, Boolean disconnectOnFailure, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportOptions.CreateDefaultBoundListenSocket(EndPoint endpoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.TransportManager.BindAsync(EndPoint endPoint, ConnectionDelegate connectionDelegate, EndpointConfig endpointConfig, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.<>c__DisplayClass28_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.LocalhostListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__14_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
2025-11-21 16:14:00.315 -06:00 [FTL] Application terminated unexpectedly
System.IO.IOException: Failed to bind to address http://127.0.0.1:5021: address already in use.
 ---> Microsoft.AspNetCore.Connections.AddressInUseException: Solo se permite un uso de cada dirección de socket (protocolo/dirección de red/puerto)
 ---> System.Net.Sockets.SocketException (10048): Solo se permite un uso de cada dirección de socket (protocolo/dirección de red/puerto)
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, Boolean disconnectOnFailure, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportOptions.CreateDefaultBoundListenSocket(EndPoint endpoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.TransportManager.BindAsync(EndPoint endPoint, ConnectionDelegate connectionDelegate, EndpointConfig endpointConfig, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.<>c__DisplayClass28_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.LocalhostListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__14_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in D:\REPOSITORY\HelpDesk\HelpDesk.API\Program.cs:line 93
2025-11-21 16:20:33.384 -06:00 [INF] Starting HelpDesk API
2025-11-21 16:20:33.913 -06:00 [INF] User profile is available. Using 'C:\Users\marvin.gonzalez\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-21 16:20:35.055 -06:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-21 16:20:35.076 -06:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-21 16:20:35.106 -06:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-21 16:20:35.198 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-21 16:20:35.229 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-21 16:20:35.239 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-21 16:20:35.252 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-21 16:20:35.275 -06:00 [INF] No migrations were applied. The database is already up to date.
2025-11-21 16:20:35.282 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-21 16:20:35.686 -06:00 [INF] Executed DbCommand (18ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0
2025-11-21 16:20:35.749 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0
2025-11-21 16:20:35.757 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0
2025-11-21 16:20:35.782 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[Name] = N'Admin'
2025-11-21 16:20:35.803 -06:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[Name] = N'Support'
2025-11-21 16:20:35.835 -06:00 [INF] Executed DbCommand (5ms) [Parameters=[@__8__locals1_adminRole_Id_0='?' (DbType = Int32), @__permission_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleId] = @__8__locals1_adminRole_Id_0 AND [r].[Permission] = @__permission_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 16:20:35.868 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_adminRole_Id_0='?' (DbType = Int32), @__permission_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleId] = @__8__locals1_adminRole_Id_0 AND [r].[Permission] = @__permission_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 16:20:35.877 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_adminRole_Id_0='?' (DbType = Int32), @__permission_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleId] = @__8__locals1_adminRole_Id_0 AND [r].[Permission] = @__permission_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 16:20:35.883 -06:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_adminRole_Id_0='?' (DbType = Int32), @__permission_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleId] = @__8__locals1_adminRole_Id_0 AND [r].[Permission] = @__permission_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 16:20:35.893 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_adminRole_Id_0='?' (DbType = Int32), @__permission_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleId] = @__8__locals1_adminRole_Id_0 AND [r].[Permission] = @__permission_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 16:20:35.900 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_adminRole_Id_0='?' (DbType = Int32), @__permission_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleId] = @__8__locals1_adminRole_Id_0 AND [r].[Permission] = @__permission_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 16:20:35.907 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_adminRole_Id_0='?' (DbType = Int32), @__permission_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleId] = @__8__locals1_adminRole_Id_0 AND [r].[Permission] = @__permission_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 16:20:35.921 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__8__locals2_supportRole_Id_0='?' (DbType = Int32), @__permission_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleId] = @__8__locals2_supportRole_Id_0 AND [r].[Permission] = @__permission_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 16:20:35.929 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals2_supportRole_Id_0='?' (DbType = Int32), @__permission_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleId] = @__8__locals2_supportRole_Id_0 AND [r].[Permission] = @__permission_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 16:20:35.936 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals2_supportRole_Id_0='?' (DbType = Int32), @__permission_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleId] = @__8__locals2_supportRole_Id_0 AND [r].[Permission] = @__permission_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 16:20:35.942 -06:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals2_supportRole_Id_0='?' (DbType = Int32), @__permission_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleId] = @__8__locals2_supportRole_Id_0 AND [r].[Permission] = @__permission_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 16:20:36.057 -06:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Size = 100), @p1='?' (DbType = Int32), @p2='?' (Size = 100), @p3='?' (DbType = Int32), @p4='?' (Size = 100), @p5='?' (DbType = Int32), @p6='?' (Size = 100), @p7='?' (DbType = Int32), @p8='?' (Size = 100), @p9='?' (DbType = Int32), @p10='?' (Size = 100), @p11='?' (DbType = Int32), @p12='?' (Size = 100), @p13='?' (DbType = Int32), @p14='?' (Size = 100), @p15='?' (DbType = Int32), @p16='?' (Size = 100), @p17='?' (DbType = Int32), @p18='?' (Size = 100), @p19='?' (DbType = Int32), @p20='?' (Size = 100), @p21='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [security].[RolePermissions] USING (
VALUES (@p0, @p1, 0),
(@p2, @p3, 1),
(@p4, @p5, 2),
(@p6, @p7, 3),
(@p8, @p9, 4),
(@p10, @p11, 5),
(@p12, @p13, 6),
(@p14, @p15, 7),
(@p16, @p17, 8),
(@p18, @p19, 9),
(@p20, @p21, 10)) AS i ([Permission], [RoleId], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([Permission], [RoleId])
VALUES (i.[Permission], i.[RoleId])
OUTPUT INSERTED.[Id], i._Position;
2025-11-21 16:20:36.103 -06:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [security].[Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-21 16:20:36.162 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedRoleName_0
2025-11-21 16:20:36.204 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[RoleId]
FROM [security].[UserRoles] AS [u]
WHERE [u].[UserId] = @__p_0 AND [u].[RoleId] = @__p_1
2025-11-21 16:20:36.223 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [helpdesk].[CatalogItems] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 16:20:36.235 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [catalog].[Catalogs] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 16:20:36.243 -06:00 [INF] HelpDesk API started successfully
2025-11-21 16:20:36.309 -06:00 [INF] Now listening on: http://localhost:5022
2025-11-21 16:20:36.312 -06:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-21 16:20:36.315 -06:00 [INF] Hosting environment: Development
2025-11-21 16:20:36.316 -06:00 [INF] Content root path: D:\REPOSITORY\HelpDesk\HelpDesk.API
2025-11-21 16:20:59.536 -06:00 [INF] Request starting HTTP/1.1 GET http://localhost:5022/ - null null
2025-11-21 16:20:59.635 -06:00 [INF] HTTP GET / responded 301 in 39.1631 ms
2025-11-21 16:20:59.658 -06:00 [INF] Request finished HTTP/1.1 GET http://localhost:5022/ - 301 0 null 124.4889ms
2025-11-21 16:20:59.671 -06:00 [INF] Request starting HTTP/1.1 GET http://localhost:5022/index.html - null null
2025-11-21 16:20:59.769 -06:00 [INF] HTTP GET /index.html responded 200 in 89.1331 ms
2025-11-21 16:20:59.773 -06:00 [INF] Request finished HTTP/1.1 GET http://localhost:5022/index.html - 200 null text/html;charset=utf-8 102.176ms
2025-11-21 16:20:59.801 -06:00 [INF] Request starting HTTP/1.1 GET http://localhost:5022/index.css - null null
2025-11-21 16:20:59.803 -06:00 [INF] Request starting HTTP/1.1 GET http://localhost:5022/swagger-ui-bundle.js - null null
2025-11-21 16:20:59.803 -06:00 [INF] Request starting HTTP/1.1 GET http://localhost:5022/swagger-ui-standalone-preset.js - null null
2025-11-21 16:20:59.803 -06:00 [INF] Request starting HTTP/1.1 GET http://localhost:5022/swagger-ui.css - null null
2025-11-21 16:20:59.803 -06:00 [INF] Request starting HTTP/1.1 GET http://localhost:5022/index.js - null null
2025-11-21 16:20:59.829 -06:00 [INF] HTTP GET /index.js responded 200 in 1.5817 ms
2025-11-21 16:20:59.833 -06:00 [INF] Request finished HTTP/1.1 GET http://localhost:5022/index.js - 200 null application/javascript;charset=utf-8 29.6761ms
2025-11-21 16:20:59.850 -06:00 [INF] HTTP GET /index.css responded 200 in 43.8473 ms
2025-11-21 16:20:59.850 -06:00 [INF] HTTP GET /swagger-ui.css responded 200 in 29.4447 ms
2025-11-21 16:20:59.855 -06:00 [INF] Request finished HTTP/1.1 GET http://localhost:5022/index.css - 200 152 text/css 54.2021ms
2025-11-21 16:20:59.863 -06:00 [INF] HTTP GET /swagger-ui-standalone-preset.js responded 200 in 47.1970 ms
2025-11-21 16:20:59.868 -06:00 [INF] Request finished HTTP/1.1 GET http://localhost:5022/swagger-ui.css - 200 23647 text/css 64.3125ms
2025-11-21 16:20:59.870 -06:00 [INF] HTTP GET /swagger-ui-bundle.js responded 200 in 58.0819 ms
2025-11-21 16:20:59.886 -06:00 [INF] Request finished HTTP/1.1 GET http://localhost:5022/swagger-ui-standalone-preset.js - 200 77352 text/javascript 83.5738ms
2025-11-21 16:20:59.901 -06:00 [INF] Request finished HTTP/1.1 GET http://localhost:5022/swagger-ui-bundle.js - 200 424767 text/javascript 98.5934ms
2025-11-21 16:21:00.229 -06:00 [INF] Request starting HTTP/1.1 GET http://localhost:5022/swagger/v1/swagger.json - null null
2025-11-21 16:21:00.279 -06:00 [INF] Request starting HTTP/1.1 GET http://localhost:5022/favicon-32x32.png - null null
2025-11-21 16:21:00.289 -06:00 [INF] HTTP GET /favicon-32x32.png responded 200 in 1.4917 ms
2025-11-21 16:21:00.294 -06:00 [INF] Request finished HTTP/1.1 GET http://localhost:5022/favicon-32x32.png - 200 628 image/png 14.8565ms
2025-11-21 16:21:00.407 -06:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 168.1869 ms
2025-11-21 16:21:00.423 -06:00 [INF] Request finished HTTP/1.1 GET http://localhost:5022/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 194.8263ms
2025-11-21 16:21:56.983 -06:00 [INF] Request starting HTTP/1.1 POST http://localhost:5022/api/auth/register - application/json 89
2025-11-21 16:21:56.994 -06:00 [INF] CORS policy execution successful.
2025-11-21 16:21:56.999 -06:00 [WRN] Failed to determine the https port for redirect.
2025-11-21 16:21:57.041 -06:00 [INF] Executing endpoint 'HelpDesk.Api.Controllers.AuthController.Register (HelpDesk.API)'
2025-11-21 16:21:57.061 -06:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(RegisterRequest) on controller HelpDesk.Api.Controllers.AuthController (HelpDesk.API).
2025-11-21 16:21:57.233 -06:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [security].[Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-21 16:21:57.246 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [security].[Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-21 16:21:57.283 -06:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p2='?' (Size = 256), @p3='?' (DbType = Boolean), @p4='?' (Size = 200), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 256), @p8='?' (Size = 256), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (Size = 4000), @p13='?' (DbType = Boolean), @p14='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [security].[Users] ([AccessFailedCount], [ConcurrencyStamp], [Email], [EmailConfirmed], [FullName], [LockoutEnabled], [LockoutEnd], [NormalizedEmail], [NormalizedUserName], [PasswordHash], [PhoneNumber], [PhoneNumberConfirmed], [SecurityStamp], [TwoFactorEnabled], [UserName])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
2025-11-21 16:21:57.295 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedRoleName_0
2025-11-21 16:21:57.304 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[RoleId]
FROM [security].[UserRoles] AS [u]
WHERE [u].[UserId] = @__p_0 AND [u].[RoleId] = @__p_1
2025-11-21 16:21:57.316 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedRoleName_0
2025-11-21 16:21:57.325 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [security].[Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-21 16:21:57.334 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [security].[Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-21 16:21:57.365 -06:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p17='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (Size = 4000), @p18='?' (Size = 4000), @p4='?' (Size = 256), @p5='?' (DbType = Boolean), @p6='?' (Size = 200), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTimeOffset), @p9='?' (Size = 256), @p10='?' (Size = 256), @p11='?' (Size = 4000), @p12='?' (Size = 4000), @p13='?' (DbType = Boolean), @p14='?' (Size = 4000), @p15='?' (DbType = Boolean), @p16='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [security].[UserRoles] ([RoleId], [UserId])
VALUES (@p0, @p1);
UPDATE [security].[Users] SET [AccessFailedCount] = @p2, [ConcurrencyStamp] = @p3, [Email] = @p4, [EmailConfirmed] = @p5, [FullName] = @p6, [LockoutEnabled] = @p7, [LockoutEnd] = @p8, [NormalizedEmail] = @p9, [NormalizedUserName] = @p10, [PasswordHash] = @p11, [PhoneNumber] = @p12, [PhoneNumberConfirmed] = @p13, [SecurityStamp] = @p14, [TwoFactorEnabled] = @p15, [UserName] = @p16
OUTPUT 1
WHERE [Id] = @p17 AND [ConcurrencyStamp] = @p18;
2025-11-21 16:21:57.380 -06:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2025-11-21 16:21:57.388 -06:00 [INF] Executed action HelpDesk.Api.Controllers.AuthController.Register (HelpDesk.API) in 319.4725ms
2025-11-21 16:21:57.391 -06:00 [INF] Executed endpoint 'HelpDesk.Api.Controllers.AuthController.Register (HelpDesk.API)'
2025-11-21 16:21:57.393 -06:00 [INF] HTTP POST /api/auth/register responded 200 in 399.9125 ms
2025-11-21 16:21:57.398 -06:00 [INF] Request finished HTTP/1.1 POST http://localhost:5022/api/auth/register - 200 null text/plain; charset=utf-8 415.53ms
2025-11-21 16:22:31.233 -06:00 [INF] Request starting HTTP/1.1 POST http://localhost:5022/api/auth/login - application/json 61
2025-11-21 16:22:31.247 -06:00 [INF] CORS policy execution successful.
2025-11-21 16:22:31.252 -06:00 [INF] Executing endpoint 'HelpDesk.Api.Controllers.AuthController.Login (HelpDesk.API)'
2025-11-21 16:22:31.265 -06:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest) on controller HelpDesk.Api.Controllers.AuthController (HelpDesk.API).
2025-11-21 16:22:31.341 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [security].[Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-21 16:22:31.490 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Name]
FROM [security].[UserRoles] AS [u]
INNER JOIN [security].[Roles] AS [r] ON [u].[RoleId] = [r].[Id]
WHERE [u].[UserId] = @__userId_0
2025-11-21 16:22:31.576 -06:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (DbType = Guid), @p3='?' (DbType = DateTime2), @p4='?' (Size = 200), @p5='?' (Size = 1000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 200), @p8='?' (Size = 500), @p9='?' (Size = 1000), @p10='?' (Size = 4000), @p11='?' (DbType = DateTime2), @p12='?' (DbType = DateTime2), @p13='?' (DbType = DateTime2), @p14='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [security].[UserSessions] ([CreatedAt], [IsActiveSession], [JwtId], [LoginAt], [LoginIpAddress], [LoginUserAgent], [LogoutAt], [LogoutIpAddress], [LogoutReason], [LogoutUserAgent], [RefreshToken], [RefreshTokenExpiresAt], [TokenExpiresAt], [UpdatedAt], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
2025-11-21 16:22:31.586 -06:00 [INF] Executing OkObjectResult, writing value of type 'HelpDesk.Application.DTOs.AuthResult'.
2025-11-21 16:22:31.593 -06:00 [INF] Executed action HelpDesk.Api.Controllers.AuthController.Login (HelpDesk.API) in 317.4892ms
2025-11-21 16:22:31.597 -06:00 [INF] Executed endpoint 'HelpDesk.Api.Controllers.AuthController.Login (HelpDesk.API)'
2025-11-21 16:22:31.599 -06:00 [INF] HTTP POST /api/auth/login responded 200 in 352.1848 ms
2025-11-21 16:22:31.602 -06:00 [INF] Request finished HTTP/1.1 POST http://localhost:5022/api/auth/login - 200 null application/json; charset=utf-8 368.9439ms
2025-11-21 16:22:59.557 -06:00 [INF] Request starting HTTP/1.1 GET http://localhost:5022/api/audit?Page=1&PageSize=10 - null null
2025-11-21 16:22:59.628 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__jti_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[IsActiveSession], [u].[JwtId], [u].[LoginAt], [u].[LoginIpAddress], [u].[LoginUserAgent], [u].[LogoutAt], [u].[LogoutIpAddress], [u].[LogoutReason], [u].[LogoutUserAgent], [u].[RefreshToken], [u].[RefreshTokenExpiresAt], [u].[TokenExpiresAt], [u].[UpdatedAt], [u].[UserId]
FROM [security].[UserSessions] AS [u]
WHERE [u].[JwtId] = @__jti_0
2025-11-21 16:22:59.704 -06:00 [INF] Executed DbCommand (12ms) [Parameters=[@__roleNames_0='?' (Size = 4000), @__permission_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        INNER JOIN [security].[Roles] AS [r0] ON [r].[RoleId] = [r0].[Id]
        WHERE [r0].[Name] IN (
            SELECT [r1].[value]
            FROM OPENJSON(@__roleNames_0) WITH ([value] nvarchar(256) '$') AS [r1]
        ) AND [r].[Permission] = @__permission_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 16:22:59.713 -06:00 [INF] Authorization failed. These requirements were not met:
HelpDesk.Infrastructure.Auth.PermissionRequirement
2025-11-21 16:22:59.718 -06:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-11-21 16:22:59.721 -06:00 [INF] HTTP GET /api/audit responded 403 in 158.0714 ms
2025-11-21 16:22:59.728 -06:00 [INF] Request finished HTTP/1.1 GET http://localhost:5022/api/audit?Page=1&PageSize=10 - 403 0 null 171.2166ms
