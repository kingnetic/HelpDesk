2025-11-21 13:15:15.363 -06:00 [INF] Starting HelpDesk API
2025-11-21 13:15:15.895 -06:00 [INF] User profile is available. Using 'C:\Users\marvin.gonzalez\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-21 13:15:17.024 -06:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-21 13:15:17.042 -06:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-21 13:15:17.075 -06:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-21 13:15:17.152 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-21 13:15:17.176 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-21 13:15:17.183 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-21 13:15:17.193 -06:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-21 13:15:17.217 -06:00 [INF] Applying migration '20251121184135_AddRefreshTokenToUserSession'.
2025-11-21 13:15:17.284 -06:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [security].[UserSessions] ADD [RefreshToken] nvarchar(max) NULL;
2025-11-21 13:15:17.289 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [security].[UserSessions] ADD [RefreshTokenExpiresAt] datetime2 NULL;
2025-11-21 13:15:17.295 -06:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251121184135_AddRefreshTokenToUserSession', N'9.0.11');
2025-11-21 13:15:17.308 -06:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-21 13:15:17.759 -06:00 [INF] Executed DbCommand (14ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0
2025-11-21 13:15:17.826 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0
2025-11-21 13:15:17.832 -06:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0
2025-11-21 13:15:17.852 -06:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [security].[Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-21 13:15:17.902 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedRoleName_0
2025-11-21 13:15:17.940 -06:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[RoleId]
FROM [security].[UserRoles] AS [u]
WHERE [u].[UserId] = @__p_0 AND [u].[RoleId] = @__p_1
2025-11-21 13:15:17.980 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [helpdesk].[CatalogItems] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 13:15:17.991 -06:00 [INF] HelpDesk API started successfully
2025-11-21 13:15:18.073 -06:00 [INF] Now listening on: http://localhost:5021
2025-11-21 13:15:18.076 -06:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-21 13:15:18.077 -06:00 [INF] Hosting environment: Development
2025-11-21 13:15:18.078 -06:00 [INF] Content root path: D:\REPOSITORY\HelpDesk\HelpDesk.API
2025-11-21 13:26:28.851 -06:00 [INF] Request starting HTTP/1.1 GET http://localhost:5021/swagger/v1/swagger.json - null null
2025-11-21 13:26:29.015 -06:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 129.2935 ms
2025-11-21 13:26:29.023 -06:00 [INF] Request finished HTTP/1.1 GET http://localhost:5021/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 176.7745ms
2025-11-21 13:26:41.366 -06:00 [INF] Request starting HTTP/1.1 GET http://localhost:5021/api/auth/user-info - null null
2025-11-21 13:26:41.386 -06:00 [WRN] Failed to determine the https port for redirect.
2025-11-21 13:26:41.416 -06:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-11-21 13:26:41.420 -06:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-11-21 13:26:41.422 -06:00 [INF] HTTP GET /api/auth/user-info responded 401 in 43.1509 ms
2025-11-21 13:26:41.427 -06:00 [INF] Request finished HTTP/1.1 GET http://localhost:5021/api/auth/user-info - 401 0 null 60.6542ms
2025-11-21 13:26:55.674 -06:00 [INF] Request starting HTTP/1.1 GET http://localhost:5021/api/auth/user-info - null null
2025-11-21 13:26:55.727 -06:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '21/11/2025 06:17:41', Current time (UTC): '21/11/2025 07:26:55'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-11-21 13:26:55.745 -06:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '21/11/2025 06:17:41', Current time (UTC): '21/11/2025 07:26:55'.
2025-11-21 13:26:55.749 -06:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-11-21 13:26:55.753 -06:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-11-21 13:26:55.755 -06:00 [INF] HTTP GET /api/auth/user-info responded 401 in 75.9843 ms
2025-11-21 13:26:55.758 -06:00 [INF] Request finished HTTP/1.1 GET http://localhost:5021/api/auth/user-info - 401 0 null 83.6755ms
2025-11-21 13:27:15.364 -06:00 [INF] Request starting HTTP/1.1 POST http://localhost:5021/api/auth/login - application/json 63
2025-11-21 13:27:15.371 -06:00 [INF] CORS policy execution successful.
2025-11-21 13:27:15.376 -06:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '21/11/2025 06:17:41', Current time (UTC): '21/11/2025 07:27:15'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-11-21 13:27:15.383 -06:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '21/11/2025 06:17:41', Current time (UTC): '21/11/2025 07:27:15'.
2025-11-21 13:27:15.390 -06:00 [INF] Executing endpoint 'HelpDesk.Api.Controllers.AuthController.Login (HelpDesk.API)'
2025-11-21 13:27:15.406 -06:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest) on controller HelpDesk.Api.Controllers.AuthController (HelpDesk.API).
2025-11-21 13:27:15.478 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [security].[Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-21 13:27:15.617 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Name]
FROM [security].[UserRoles] AS [u]
INNER JOIN [security].[Roles] AS [r] ON [u].[RoleId] = [r].[Id]
WHERE [u].[UserId] = @__userId_0
2025-11-21 13:27:15.766 -06:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (DbType = Guid), @p3='?' (DbType = DateTime2), @p4='?' (Size = 200), @p5='?' (Size = 1000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 200), @p8='?' (Size = 500), @p9='?' (Size = 1000), @p10='?' (Size = 4000), @p11='?' (DbType = DateTime2), @p12='?' (DbType = DateTime2), @p13='?' (DbType = DateTime2), @p14='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [security].[UserSessions] ([CreatedAt], [IsActiveSession], [JwtId], [LoginAt], [LoginIpAddress], [LoginUserAgent], [LogoutAt], [LogoutIpAddress], [LogoutReason], [LogoutUserAgent], [RefreshToken], [RefreshTokenExpiresAt], [TokenExpiresAt], [UpdatedAt], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
2025-11-21 13:27:15.795 -06:00 [INF] Executing OkObjectResult, writing value of type 'HelpDesk.Application.DTOs.AuthResult'.
2025-11-21 13:27:15.807 -06:00 [INF] Executed action HelpDesk.Api.Controllers.AuthController.Login (HelpDesk.API) in 395.2586ms
2025-11-21 13:27:15.810 -06:00 [INF] Executed endpoint 'HelpDesk.Api.Controllers.AuthController.Login (HelpDesk.API)'
2025-11-21 13:27:15.815 -06:00 [INF] HTTP POST /api/auth/login responded 200 in 445.7248 ms
2025-11-21 13:27:15.821 -06:00 [INF] Request finished HTTP/1.1 POST http://localhost:5021/api/auth/login - 200 null application/json; charset=utf-8 456.4886ms
2025-11-21 13:27:47.622 -06:00 [INF] Request starting HTTP/1.1 GET http://localhost:5021/api/auth/user-info - null null
2025-11-21 13:27:47.696 -06:00 [INF] Executed DbCommand (3ms) [Parameters=[@__jti_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[IsActiveSession], [u].[JwtId], [u].[LoginAt], [u].[LoginIpAddress], [u].[LoginUserAgent], [u].[LogoutAt], [u].[LogoutIpAddress], [u].[LogoutReason], [u].[LogoutUserAgent], [u].[RefreshToken], [u].[RefreshTokenExpiresAt], [u].[TokenExpiresAt], [u].[UpdatedAt], [u].[UserId]
FROM [security].[UserSessions] AS [u]
WHERE [u].[JwtId] = @__jti_0
2025-11-21 13:27:47.707 -06:00 [INF] Executing endpoint 'HelpDesk.Api.Controllers.AuthController.GetCurrentUser (HelpDesk.API)'
2025-11-21 13:27:47.712 -06:00 [INF] Route matched with {action = "GetCurrentUser", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCurrentUser() on controller HelpDesk.Api.Controllers.AuthController (HelpDesk.API).
2025-11-21 13:27:47.721 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [security].[Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-21 13:27:47.729 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Name]
FROM [security].[UserRoles] AS [u]
INNER JOIN [security].[Roles] AS [r] ON [u].[RoleId] = [r].[Id]
WHERE [u].[UserId] = @__userId_0
2025-11-21 13:27:47.734 -06:00 [INF] Executing OkObjectResult, writing value of type 'HelpDesk.Application.DTOs.UserDto'.
2025-11-21 13:27:47.743 -06:00 [INF] Executed action HelpDesk.Api.Controllers.AuthController.GetCurrentUser (HelpDesk.API) in 27.9829ms
2025-11-21 13:27:47.745 -06:00 [INF] Executed endpoint 'HelpDesk.Api.Controllers.AuthController.GetCurrentUser (HelpDesk.API)'
2025-11-21 13:27:47.747 -06:00 [INF] HTTP GET /api/auth/user-info responded 200 in 119.7705 ms
2025-11-21 13:27:47.750 -06:00 [INF] Request finished HTTP/1.1 GET http://localhost:5021/api/auth/user-info - 200 null application/json; charset=utf-8 127.604ms
2025-11-21 13:28:00.596 -06:00 [INF] Request starting HTTP/1.1 GET http://localhost:5021/api/audit - null null
2025-11-21 13:28:00.607 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__jti_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[IsActiveSession], [u].[JwtId], [u].[LoginAt], [u].[LoginIpAddress], [u].[LoginUserAgent], [u].[LogoutAt], [u].[LogoutIpAddress], [u].[LogoutReason], [u].[LogoutUserAgent], [u].[RefreshToken], [u].[RefreshTokenExpiresAt], [u].[TokenExpiresAt], [u].[UpdatedAt], [u].[UserId]
FROM [security].[UserSessions] AS [u]
WHERE [u].[JwtId] = @__jti_0
2025-11-21 13:28:00.697 -06:00 [INF] Executed DbCommand (11ms) [Parameters=[@__roleNames_0='?' (Size = 4000), @__permission_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        INNER JOIN [security].[Role] AS [r0] ON [r].[RoleId] = [r0].[Id]
        WHERE [r0].[Name] IN (
            SELECT [r1].[value]
            FROM OPENJSON(@__roleNames_0) WITH ([value] nvarchar(max) '$') AS [r1]
        ) AND [r].[Permission] = @__permission_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 13:28:00.703 -06:00 [INF] Authorization failed. These requirements were not met:
HelpDesk.Infrastructure.Auth.PermissionRequirement
2025-11-21 13:28:00.706 -06:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-11-21 13:28:00.707 -06:00 [INF] HTTP GET /api/audit responded 403 in 105.9414 ms
2025-11-21 13:28:00.709 -06:00 [INF] Request finished HTTP/1.1 GET http://localhost:5021/api/audit - 403 0 null 113.0985ms
2025-11-21 13:28:14.010 -06:00 [INF] Request starting HTTP/1.1 GET http://localhost:5021/api/audit?Page=1&PageSize=10 - null null
2025-11-21 13:28:14.016 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__jti_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[IsActiveSession], [u].[JwtId], [u].[LoginAt], [u].[LoginIpAddress], [u].[LoginUserAgent], [u].[LogoutAt], [u].[LogoutIpAddress], [u].[LogoutReason], [u].[LogoutUserAgent], [u].[RefreshToken], [u].[RefreshTokenExpiresAt], [u].[TokenExpiresAt], [u].[UpdatedAt], [u].[UserId]
FROM [security].[UserSessions] AS [u]
WHERE [u].[JwtId] = @__jti_0
2025-11-21 13:28:14.021 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__roleNames_0='?' (Size = 4000), @__permission_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        INNER JOIN [security].[Role] AS [r0] ON [r].[RoleId] = [r0].[Id]
        WHERE [r0].[Name] IN (
            SELECT [r1].[value]
            FROM OPENJSON(@__roleNames_0) WITH ([value] nvarchar(max) '$') AS [r1]
        ) AND [r].[Permission] = @__permission_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 13:28:14.028 -06:00 [INF] Authorization failed. These requirements were not met:
HelpDesk.Infrastructure.Auth.PermissionRequirement
2025-11-21 13:28:14.030 -06:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-11-21 13:28:14.032 -06:00 [INF] HTTP GET /api/audit responded 403 in 18.3962 ms
2025-11-21 13:28:14.034 -06:00 [INF] Request finished HTTP/1.1 GET http://localhost:5021/api/audit?Page=1&PageSize=10 - 403 0 null 24.4761ms
2025-11-21 13:28:54.539 -06:00 [INF] Request starting HTTP/1.1 GET http://localhost:5021/api/Catalogs - null null
2025-11-21 13:28:54.548 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__jti_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[IsActiveSession], [u].[JwtId], [u].[LoginAt], [u].[LoginIpAddress], [u].[LoginUserAgent], [u].[LogoutAt], [u].[LogoutIpAddress], [u].[LogoutReason], [u].[LogoutUserAgent], [u].[RefreshToken], [u].[RefreshTokenExpiresAt], [u].[TokenExpiresAt], [u].[UpdatedAt], [u].[UserId]
FROM [security].[UserSessions] AS [u]
WHERE [u].[JwtId] = @__jti_0
2025-11-21 13:28:54.553 -06:00 [INF] Executing endpoint 'HelpDesk.Api.Controllers.CatalogsController.GetCatalogs (HelpDesk.API)'
2025-11-21 13:28:54.558 -06:00 [INF] Route matched with {action = "GetCatalogs", controller = "Catalogs"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCatalogs() on controller HelpDesk.Api.Controllers.CatalogsController (HelpDesk.API).
2025-11-21 13:28:54.565 -06:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-21 13:28:54.583 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name], [c].[Type]
FROM [helpdesk].[CatalogItems] AS [c]
2025-11-21 13:28:54.588 -06:00 [INF] Executing OkObjectResult, writing value of type 'HelpDesk.Application.DTOs.CatalogsResultDto'.
2025-11-21 13:28:54.593 -06:00 [INF] Executed action HelpDesk.Api.Controllers.CatalogsController.GetCatalogs (HelpDesk.API) in 32.4786ms
2025-11-21 13:28:54.595 -06:00 [INF] Executed endpoint 'HelpDesk.Api.Controllers.CatalogsController.GetCatalogs (HelpDesk.API)'
2025-11-21 13:28:54.596 -06:00 [INF] HTTP GET /api/Catalogs responded 200 in 52.4019 ms
2025-11-21 13:28:54.598 -06:00 [INF] Request finished HTTP/1.1 GET http://localhost:5021/api/Catalogs - 200 null application/json; charset=utf-8 59.1007ms
2025-11-21 13:29:08.948 -06:00 [INF] Request starting HTTP/1.1 GET http://localhost:5021/api/Roles - null null
2025-11-21 13:29:08.956 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__jti_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[IsActiveSession], [u].[JwtId], [u].[LoginAt], [u].[LoginIpAddress], [u].[LoginUserAgent], [u].[LogoutAt], [u].[LogoutIpAddress], [u].[LogoutReason], [u].[LogoutUserAgent], [u].[RefreshToken], [u].[RefreshTokenExpiresAt], [u].[TokenExpiresAt], [u].[UpdatedAt], [u].[UserId]
FROM [security].[UserSessions] AS [u]
WHERE [u].[JwtId] = @__jti_0
2025-11-21 13:29:08.968 -06:00 [INF] Executed DbCommand (7ms) [Parameters=[@__roleNames_0='?' (Size = 4000), @__permission_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        INNER JOIN [security].[Role] AS [r0] ON [r].[RoleId] = [r0].[Id]
        WHERE [r0].[Name] IN (
            SELECT [r1].[value]
            FROM OPENJSON(@__roleNames_0) WITH ([value] nvarchar(max) '$') AS [r1]
        ) AND [r].[Permission] = @__permission_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 13:29:08.973 -06:00 [INF] Authorization failed. These requirements were not met:
HelpDesk.Infrastructure.Auth.PermissionRequirement
2025-11-21 13:29:08.975 -06:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-11-21 13:29:08.976 -06:00 [INF] HTTP GET /api/Roles responded 403 in 23.9136 ms
2025-11-21 13:29:08.979 -06:00 [INF] Request finished HTTP/1.1 GET http://localhost:5021/api/Roles - 403 0 null 31.045ms
2025-11-21 13:29:45.858 -06:00 [INF] Request starting HTTP/1.1 GET http://localhost:5021/api/Users - null null
2025-11-21 13:29:45.864 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__jti_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[IsActiveSession], [u].[JwtId], [u].[LoginAt], [u].[LoginIpAddress], [u].[LoginUserAgent], [u].[LogoutAt], [u].[LogoutIpAddress], [u].[LogoutReason], [u].[LogoutUserAgent], [u].[RefreshToken], [u].[RefreshTokenExpiresAt], [u].[TokenExpiresAt], [u].[UpdatedAt], [u].[UserId]
FROM [security].[UserSessions] AS [u]
WHERE [u].[JwtId] = @__jti_0
2025-11-21 13:29:45.868 -06:00 [INF] Executing endpoint 'HelpDesk.Api.Controllers.UsersController.GetUsers (HelpDesk.API)'
2025-11-21 13:29:45.872 -06:00 [INF] Route matched with {action = "GetUsers", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers() on controller HelpDesk.Api.Controllers.UsersController (HelpDesk.API).
2025-11-21 13:29:45.884 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[FullName]
FROM [security].[Users] AS [u]
2025-11-21 13:29:45.890 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Name]
FROM [security].[UserRoles] AS [u]
INNER JOIN [security].[Roles] AS [r] ON [u].[RoleId] = [r].[Id]
WHERE [u].[UserId] = @__userId_0
2025-11-21 13:29:45.894 -06:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[HelpDesk.Application.DTOs.UserDto, HelpDesk.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-21 13:29:45.896 -06:00 [INF] Executed action HelpDesk.Api.Controllers.UsersController.GetUsers (HelpDesk.API) in 20.2314ms
2025-11-21 13:29:45.897 -06:00 [INF] Executed endpoint 'HelpDesk.Api.Controllers.UsersController.GetUsers (HelpDesk.API)'
2025-11-21 13:29:45.898 -06:00 [INF] HTTP GET /api/Users responded 200 in 36.1576 ms
2025-11-21 13:29:45.900 -06:00 [INF] Request finished HTTP/1.1 GET http://localhost:5021/api/Users - 200 null application/json; charset=utf-8 42.0053ms
2025-11-21 13:29:56.939 -06:00 [INF] Request starting HTTP/1.1 GET http://localhost:5021/api/Roles - null null
2025-11-21 13:29:56.947 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__jti_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[IsActiveSession], [u].[JwtId], [u].[LoginAt], [u].[LoginIpAddress], [u].[LoginUserAgent], [u].[LogoutAt], [u].[LogoutIpAddress], [u].[LogoutReason], [u].[LogoutUserAgent], [u].[RefreshToken], [u].[RefreshTokenExpiresAt], [u].[TokenExpiresAt], [u].[UpdatedAt], [u].[UserId]
FROM [security].[UserSessions] AS [u]
WHERE [u].[JwtId] = @__jti_0
2025-11-21 13:29:56.961 -06:00 [INF] Executed DbCommand (8ms) [Parameters=[@__roleNames_0='?' (Size = 4000), @__permission_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        INNER JOIN [security].[Role] AS [r0] ON [r].[RoleId] = [r0].[Id]
        WHERE [r0].[Name] IN (
            SELECT [r1].[value]
            FROM OPENJSON(@__roleNames_0) WITH ([value] nvarchar(max) '$') AS [r1]
        ) AND [r].[Permission] = @__permission_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 13:29:56.966 -06:00 [INF] Authorization failed. These requirements were not met:
HelpDesk.Infrastructure.Auth.PermissionRequirement
2025-11-21 13:29:56.968 -06:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-11-21 13:29:56.970 -06:00 [INF] HTTP GET /api/Roles responded 403 in 26.6054 ms
2025-11-21 13:29:56.973 -06:00 [INF] Request finished HTTP/1.1 GET http://localhost:5021/api/Roles - 403 0 null 33.705ms
2025-11-21 13:38:44.751 -06:00 [INF] Request starting HTTP/1.1 GET http://localhost:5021/api/Roles - null null
2025-11-21 13:38:44.768 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__jti_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[IsActiveSession], [u].[JwtId], [u].[LoginAt], [u].[LoginIpAddress], [u].[LoginUserAgent], [u].[LogoutAt], [u].[LogoutIpAddress], [u].[LogoutReason], [u].[LogoutUserAgent], [u].[RefreshToken], [u].[RefreshTokenExpiresAt], [u].[TokenExpiresAt], [u].[UpdatedAt], [u].[UserId]
FROM [security].[UserSessions] AS [u]
WHERE [u].[JwtId] = @__jti_0
2025-11-21 13:38:44.786 -06:00 [INF] Executed DbCommand (12ms) [Parameters=[@__roleNames_0='?' (Size = 4000), @__permission_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        INNER JOIN [security].[Role] AS [r0] ON [r].[RoleId] = [r0].[Id]
        WHERE [r0].[Name] IN (
            SELECT [r1].[value]
            FROM OPENJSON(@__roleNames_0) WITH ([value] nvarchar(max) '$') AS [r1]
        ) AND [r].[Permission] = @__permission_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 13:38:44.793 -06:00 [INF] Authorization failed. These requirements were not met:
HelpDesk.Infrastructure.Auth.PermissionRequirement
2025-11-21 13:38:44.794 -06:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-11-21 13:38:44.796 -06:00 [INF] HTTP GET /api/Roles responded 403 in 39.5345 ms
2025-11-21 13:38:44.799 -06:00 [INF] Request finished HTTP/1.1 GET http://localhost:5021/api/Roles - 403 0 null 47.9313ms
2025-11-21 13:44:13.315 -06:00 [INF] Request starting HTTP/1.1 GET http://localhost:5021/api/Users - null null
2025-11-21 13:44:13.328 -06:00 [INF] Executed DbCommand (3ms) [Parameters=[@__jti_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[IsActiveSession], [u].[JwtId], [u].[LoginAt], [u].[LoginIpAddress], [u].[LoginUserAgent], [u].[LogoutAt], [u].[LogoutIpAddress], [u].[LogoutReason], [u].[LogoutUserAgent], [u].[RefreshToken], [u].[RefreshTokenExpiresAt], [u].[TokenExpiresAt], [u].[UpdatedAt], [u].[UserId]
FROM [security].[UserSessions] AS [u]
WHERE [u].[JwtId] = @__jti_0
2025-11-21 13:44:13.336 -06:00 [INF] Executing endpoint 'HelpDesk.Api.Controllers.UsersController.GetUsers (HelpDesk.API)'
2025-11-21 13:44:13.338 -06:00 [INF] Route matched with {action = "GetUsers", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers() on controller HelpDesk.Api.Controllers.UsersController (HelpDesk.API).
2025-11-21 13:44:13.343 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[FullName]
FROM [security].[Users] AS [u]
2025-11-21 13:44:13.350 -06:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Name]
FROM [security].[UserRoles] AS [u]
INNER JOIN [security].[Roles] AS [r] ON [u].[RoleId] = [r].[Id]
WHERE [u].[UserId] = @__userId_0
2025-11-21 13:44:13.354 -06:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[HelpDesk.Application.DTOs.UserDto, HelpDesk.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-21 13:44:13.356 -06:00 [INF] Executed action HelpDesk.Api.Controllers.UsersController.GetUsers (HelpDesk.API) in 15.6889ms
2025-11-21 13:44:13.358 -06:00 [INF] Executed endpoint 'HelpDesk.Api.Controllers.UsersController.GetUsers (HelpDesk.API)'
2025-11-21 13:44:13.359 -06:00 [INF] HTTP GET /api/Users responded 200 in 36.9568 ms
2025-11-21 13:44:13.362 -06:00 [INF] Request finished HTTP/1.1 GET http://localhost:5021/api/Users - 200 null application/json; charset=utf-8 47.1589ms
2025-11-21 13:44:30.368 -06:00 [INF] Request starting HTTP/1.1 GET http://localhost:5021/api/Tickets?Page=1&PageSize=10 - null null
2025-11-21 13:44:30.391 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__jti_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[IsActiveSession], [u].[JwtId], [u].[LoginAt], [u].[LoginIpAddress], [u].[LoginUserAgent], [u].[LogoutAt], [u].[LogoutIpAddress], [u].[LogoutReason], [u].[LogoutUserAgent], [u].[RefreshToken], [u].[RefreshTokenExpiresAt], [u].[TokenExpiresAt], [u].[UpdatedAt], [u].[UserId]
FROM [security].[UserSessions] AS [u]
WHERE [u].[JwtId] = @__jti_0
2025-11-21 13:44:30.396 -06:00 [INF] Executing endpoint 'HelpDesk.Api.Controllers.TicketsController.GetTickets (HelpDesk.API)'
2025-11-21 13:44:30.407 -06:00 [INF] Route matched with {action = "GetTickets", controller = "Tickets"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTickets(HelpDesk.Application.DTOs.TicketFilterRequest) on controller HelpDesk.Api.Controllers.TicketsController (HelpDesk.API).
2025-11-21 13:44:30.442 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [helpdesk].[Tickets] AS [t]
2025-11-21 13:44:30.457 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Title], [t].[StatusId], [t].[PriorityId], [t].[CategoryId], [t].[TypeId], [t].[CreatedById], [t].[AssignedToEmployeeId], [t].[TicketCreatedAt]
FROM [helpdesk].[Tickets] AS [t]
ORDER BY [t].[TicketCreatedAt] DESC
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
2025-11-21 13:44:30.460 -06:00 [INF] Executing OkObjectResult, writing value of type 'HelpDesk.Application.DTOs.PagedResult`1[[HelpDesk.Application.DTOs.TicketListItemDto, HelpDesk.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-21 13:44:30.470 -06:00 [INF] Executed action HelpDesk.Api.Controllers.TicketsController.GetTickets (HelpDesk.API) in 61.0501ms
2025-11-21 13:44:30.472 -06:00 [INF] Executed endpoint 'HelpDesk.Api.Controllers.TicketsController.GetTickets (HelpDesk.API)'
2025-11-21 13:44:30.473 -06:00 [INF] HTTP GET /api/Tickets responded 200 in 85.9252 ms
2025-11-21 13:44:30.475 -06:00 [INF] Request finished HTTP/1.1 GET http://localhost:5021/api/Tickets?Page=1&PageSize=10 - 200 null application/json; charset=utf-8 106.8474ms
2025-11-21 13:44:42.764 -06:00 [INF] Request starting HTTP/1.1 GET http://localhost:5021/api/Roles - null null
2025-11-21 13:44:42.783 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__jti_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[IsActiveSession], [u].[JwtId], [u].[LoginAt], [u].[LoginIpAddress], [u].[LoginUserAgent], [u].[LogoutAt], [u].[LogoutIpAddress], [u].[LogoutReason], [u].[LogoutUserAgent], [u].[RefreshToken], [u].[RefreshTokenExpiresAt], [u].[TokenExpiresAt], [u].[UpdatedAt], [u].[UserId]
FROM [security].[UserSessions] AS [u]
WHERE [u].[JwtId] = @__jti_0
2025-11-21 13:44:42.797 -06:00 [INF] Executed DbCommand (9ms) [Parameters=[@__roleNames_0='?' (Size = 4000), @__permission_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        INNER JOIN [security].[Role] AS [r0] ON [r].[RoleId] = [r0].[Id]
        WHERE [r0].[Name] IN (
            SELECT [r1].[value]
            FROM OPENJSON(@__roleNames_0) WITH ([value] nvarchar(max) '$') AS [r1]
        ) AND [r].[Permission] = @__permission_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 13:44:42.802 -06:00 [INF] Authorization failed. These requirements were not met:
HelpDesk.Infrastructure.Auth.PermissionRequirement
2025-11-21 13:44:42.803 -06:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-11-21 13:44:42.804 -06:00 [INF] HTTP GET /api/Roles responded 403 in 24.1480 ms
2025-11-21 13:44:42.806 -06:00 [INF] Request finished HTTP/1.1 GET http://localhost:5021/api/Roles - 403 0 null 41.8144ms
2025-11-21 13:44:54.197 -06:00 [INF] Request starting HTTP/1.1 GET http://localhost:5021/api/Catalogs - null null
2025-11-21 13:44:54.204 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__jti_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[IsActiveSession], [u].[JwtId], [u].[LoginAt], [u].[LoginIpAddress], [u].[LoginUserAgent], [u].[LogoutAt], [u].[LogoutIpAddress], [u].[LogoutReason], [u].[LogoutUserAgent], [u].[RefreshToken], [u].[RefreshTokenExpiresAt], [u].[TokenExpiresAt], [u].[UpdatedAt], [u].[UserId]
FROM [security].[UserSessions] AS [u]
WHERE [u].[JwtId] = @__jti_0
2025-11-21 13:44:54.210 -06:00 [INF] Executing endpoint 'HelpDesk.Api.Controllers.CatalogsController.GetCatalogs (HelpDesk.API)'
2025-11-21 13:44:54.212 -06:00 [INF] Route matched with {action = "GetCatalogs", controller = "Catalogs"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCatalogs() on controller HelpDesk.Api.Controllers.CatalogsController (HelpDesk.API).
2025-11-21 13:44:54.217 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name], [c].[Type]
FROM [helpdesk].[CatalogItems] AS [c]
2025-11-21 13:44:54.221 -06:00 [INF] Executing OkObjectResult, writing value of type 'HelpDesk.Application.DTOs.CatalogsResultDto'.
2025-11-21 13:44:54.224 -06:00 [INF] Executed action HelpDesk.Api.Controllers.CatalogsController.GetCatalogs (HelpDesk.API) in 9.1806ms
2025-11-21 13:44:54.225 -06:00 [INF] Executed endpoint 'HelpDesk.Api.Controllers.CatalogsController.GetCatalogs (HelpDesk.API)'
2025-11-21 13:44:54.227 -06:00 [INF] HTTP GET /api/Catalogs responded 200 in 25.8805 ms
2025-11-21 13:44:54.229 -06:00 [INF] Request finished HTTP/1.1 GET http://localhost:5021/api/Catalogs - 200 null application/json; charset=utf-8 32.4188ms
2025-11-21 13:45:02.985 -06:00 [INF] Request starting HTTP/1.1 GET http://localhost:5021/api/audit?Page=1&PageSize=10 - null null
2025-11-21 13:45:02.991 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__jti_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[IsActiveSession], [u].[JwtId], [u].[LoginAt], [u].[LoginIpAddress], [u].[LoginUserAgent], [u].[LogoutAt], [u].[LogoutIpAddress], [u].[LogoutReason], [u].[LogoutUserAgent], [u].[RefreshToken], [u].[RefreshTokenExpiresAt], [u].[TokenExpiresAt], [u].[UpdatedAt], [u].[UserId]
FROM [security].[UserSessions] AS [u]
WHERE [u].[JwtId] = @__jti_0
2025-11-21 13:45:02.997 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__roleNames_0='?' (Size = 4000), @__permission_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        INNER JOIN [security].[Role] AS [r0] ON [r].[RoleId] = [r0].[Id]
        WHERE [r0].[Name] IN (
            SELECT [r1].[value]
            FROM OPENJSON(@__roleNames_0) WITH ([value] nvarchar(max) '$') AS [r1]
        ) AND [r].[Permission] = @__permission_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 13:45:03.002 -06:00 [INF] Authorization failed. These requirements were not met:
HelpDesk.Infrastructure.Auth.PermissionRequirement
2025-11-21 13:45:03.003 -06:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-11-21 13:45:03.005 -06:00 [INF] HTTP GET /api/audit responded 403 in 16.4999 ms
2025-11-21 13:45:03.010 -06:00 [INF] Request finished HTTP/1.1 GET http://localhost:5021/api/audit?Page=1&PageSize=10 - 403 0 null 24.023ms
2025-11-21 14:21:54.912 -06:00 [INF] Starting HelpDesk API
2025-11-21 14:21:55.526 -06:00 [INF] User profile is available. Using 'C:\Users\marvin.gonzalez\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-21 14:21:56.693 -06:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-21 14:21:56.712 -06:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-21 14:21:56.755 -06:00 [INF] Executed DbCommand (35ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-21 14:21:56.860 -06:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-21 14:21:56.898 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-21 14:21:56.908 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-21 14:21:56.932 -06:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-21 14:21:56.970 -06:00 [INF] Applying migration '20251121195907_AddRecursiveCatalogTable'.
2025-11-21 14:21:57.057 -06:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF SCHEMA_ID(N'catalog') IS NULL EXEC(N'CREATE SCHEMA [catalog];');
2025-11-21 14:21:57.072 -06:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [catalog].[Catalogs] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(100) NOT NULL,
    [Value] nvarchar(200) NULL,
    [ParentId] int NULL,
    [IsActive] bit NOT NULL DEFAULT CAST(1 AS bit),
    [DisplayOrder] int NOT NULL DEFAULT 0,
    [Description] nvarchar(500) NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NULL,
    CONSTRAINT [PK_Catalogs] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Catalogs_Catalogs_ParentId] FOREIGN KEY ([ParentId]) REFERENCES [catalog].[Catalogs] ([Id]) ON DELETE NO ACTION
);
2025-11-21 14:21:57.082 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Catalogs_Name] ON [catalog].[Catalogs] ([Name]);
2025-11-21 14:21:57.087 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Catalogs_ParentId] ON [catalog].[Catalogs] ([ParentId]);
2025-11-21 14:21:57.093 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Catalogs_ParentId_DisplayOrder] ON [catalog].[Catalogs] ([ParentId], [DisplayOrder]);
2025-11-21 14:21:57.102 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251121195907_AddRecursiveCatalogTable', N'9.0.11');
2025-11-21 14:21:57.116 -06:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-21 14:21:57.523 -06:00 [INF] Executed DbCommand (14ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0
2025-11-21 14:21:57.574 -06:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0
2025-11-21 14:21:57.583 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0
2025-11-21 14:21:57.723 -06:00 [INF] Executed DbCommand (121ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[Name] = N'Admin'
2025-11-21 14:21:57.752 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__8__locals1_adminRole_Id_0='?' (DbType = Int32), @__permission_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleId] = @__8__locals1_adminRole_Id_0 AND [r].[Permission] = @__permission_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:21:57.793 -06:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_adminRole_Id_0='?' (DbType = Int32), @__permission_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleId] = @__8__locals1_adminRole_Id_0 AND [r].[Permission] = @__permission_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:21:57.801 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_adminRole_Id_0='?' (DbType = Int32), @__permission_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleId] = @__8__locals1_adminRole_Id_0 AND [r].[Permission] = @__permission_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:21:57.808 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_adminRole_Id_0='?' (DbType = Int32), @__permission_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleId] = @__8__locals1_adminRole_Id_0 AND [r].[Permission] = @__permission_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:21:57.814 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_adminRole_Id_0='?' (DbType = Int32), @__permission_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleId] = @__8__locals1_adminRole_Id_0 AND [r].[Permission] = @__permission_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:21:57.819 -06:00 [INF] Executed DbCommand (0ms) [Parameters=[@__8__locals1_adminRole_Id_0='?' (DbType = Int32), @__permission_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleId] = @__8__locals1_adminRole_Id_0 AND [r].[Permission] = @__permission_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:21:57.831 -06:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[Name] = N'Support'
2025-11-21 14:21:57.844 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__8__locals2_supportRole_Id_0='?' (DbType = Int32), @__permission_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleId] = @__8__locals2_supportRole_Id_0 AND [r].[Permission] = @__permission_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:21:57.853 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals2_supportRole_Id_0='?' (DbType = Int32), @__permission_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleId] = @__8__locals2_supportRole_Id_0 AND [r].[Permission] = @__permission_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:21:57.861 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals2_supportRole_Id_0='?' (DbType = Int32), @__permission_1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleId] = @__8__locals2_supportRole_Id_0 AND [r].[Permission] = @__permission_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:21:57.960 -06:00 [INF] Executed DbCommand (18ms) [Parameters=[@p0='?' (Size = 100), @p1='?' (DbType = Int32), @p2='?' (Size = 100), @p3='?' (DbType = Int32), @p4='?' (Size = 100), @p5='?' (DbType = Int32), @p6='?' (Size = 100), @p7='?' (DbType = Int32), @p8='?' (Size = 100), @p9='?' (DbType = Int32), @p10='?' (Size = 100), @p11='?' (DbType = Int32), @p12='?' (Size = 100), @p13='?' (DbType = Int32), @p14='?' (Size = 100), @p15='?' (DbType = Int32), @p16='?' (Size = 100), @p17='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [security].[RolePermissions] USING (
VALUES (@p0, @p1, 0),
(@p2, @p3, 1),
(@p4, @p5, 2),
(@p6, @p7, 3),
(@p8, @p9, 4),
(@p10, @p11, 5),
(@p12, @p13, 6),
(@p14, @p15, 7),
(@p16, @p17, 8)) AS i ([Permission], [RoleId], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([Permission], [RoleId])
VALUES (i.[Permission], i.[RoleId])
OUTPUT INSERTED.[Id], i._Position;
2025-11-21 14:21:58.014 -06:00 [ERR] An exception occurred in the database while saving changes for context type 'HelpDesk.Infrastructure.Persistence.HelpDeskDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The MERGE statement conflicted with the FOREIGN KEY constraint "FK_RolePermissions_Role_RoleId". The conflict occurred in database "HelpDeskDB", table "security.Role", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:305b3e41-1950-4528-905a-139563f95a6d
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The MERGE statement conflicted with the FOREIGN KEY constraint "FK_RolePermissions_Role_RoleId". The conflict occurred in database "HelpDeskDB", table "security.Role", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:305b3e41-1950-4528-905a-139563f95a6d
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-11-21 14:21:58.052 -06:00 [ERR] An error occurred while seeding the database
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The MERGE statement conflicted with the FOREIGN KEY constraint "FK_RolePermissions_Role_RoleId". The conflict occurred in database "HelpDeskDB", table "security.Role", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:305b3e41-1950-4528-905a-139563f95a6d
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at HelpDesk.Infrastructure.Persistence.DbSeeder.SeedPermissionsAsync(HelpDeskDbContext context) in D:\REPOSITORY\HelpDesk\HelpDesk.Infrastructure\Persistence\DbSeeder.cs:line 217
   at HelpDesk.Infrastructure.Persistence.DbSeeder.SeedAsync(IServiceProvider services) in D:\REPOSITORY\HelpDesk\HelpDesk.Infrastructure\Persistence\DbSeeder.cs:line 39
   at Program.<Main>$(String[] args) in D:\REPOSITORY\HelpDesk\HelpDesk.API\Program.cs:line 84
2025-11-21 14:21:58.106 -06:00 [INF] HelpDesk API started successfully
2025-11-21 14:21:58.184 -06:00 [INF] Now listening on: http://localhost:5021
2025-11-21 14:21:58.188 -06:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-21 14:21:58.190 -06:00 [INF] Hosting environment: Development
2025-11-21 14:21:58.191 -06:00 [INF] Content root path: D:\REPOSITORY\HelpDesk\HelpDesk.API
2025-11-21 14:46:19.773 -06:00 [INF] Application is shutting down...
2025-11-21 14:53:23.252 -06:00 [INF] Starting HelpDesk API
2025-11-21 14:53:23.875 -06:00 [INF] User profile is available. Using 'C:\Users\marvin.gonzalez\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-21 14:53:25.106 -06:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-21 14:53:25.125 -06:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-21 14:53:25.156 -06:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-21 14:53:25.229 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-21 14:53:25.257 -06:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-21 14:53:25.266 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-21 14:53:25.280 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-21 14:53:25.300 -06:00 [INF] No migrations were applied. The database is already up to date.
2025-11-21 14:53:25.308 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-21 14:53:25.784 -06:00 [INF] Executed DbCommand (21ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0
2025-11-21 14:53:25.864 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0
2025-11-21 14:53:25.874 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0
2025-11-21 14:53:25.910 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[Roles] AS [r]
        WHERE [r].[Name] = N'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:53:25.933 -06:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[Roles] AS [r]
        WHERE [r].[Name] = N'Support') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:53:25.964 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Admin' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:53:26.011 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Admin' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:53:26.026 -06:00 [INF] Executed DbCommand (3ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Admin' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:53:26.032 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Admin' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:53:26.043 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Admin' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:53:26.055 -06:00 [INF] Executed DbCommand (4ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Admin' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:53:26.074 -06:00 [INF] Executed DbCommand (3ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Support' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:53:26.095 -06:00 [INF] Executed DbCommand (3ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Support' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:53:26.105 -06:00 [INF] Executed DbCommand (3ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Support' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:53:26.224 -06:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Size = 100), @p1='?' (Size = 256), @p2='?' (Size = 100), @p3='?' (Size = 256), @p4='?' (Size = 100), @p5='?' (Size = 256), @p6='?' (Size = 100), @p7='?' (Size = 256), @p8='?' (Size = 100), @p9='?' (Size = 256), @p10='?' (Size = 100), @p11='?' (Size = 256), @p12='?' (Size = 100), @p13='?' (Size = 256), @p14='?' (Size = 100), @p15='?' (Size = 256), @p16='?' (Size = 100), @p17='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [security].[RolePermissions] USING (
VALUES (@p0, @p1, 0),
(@p2, @p3, 1),
(@p4, @p5, 2),
(@p6, @p7, 3),
(@p8, @p9, 4),
(@p10, @p11, 5),
(@p12, @p13, 6),
(@p14, @p15, 7),
(@p16, @p17, 8)) AS i ([Permission], [RoleName], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([Permission], [RoleName])
VALUES (i.[Permission], i.[RoleName])
OUTPUT INSERTED.[Id], i._Position;
2025-11-21 14:53:26.268 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [security].[Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-21 14:53:26.322 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedRoleName_0
2025-11-21 14:53:26.366 -06:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[RoleId]
FROM [security].[UserRoles] AS [u]
WHERE [u].[UserId] = @__p_0 AND [u].[RoleId] = @__p_1
2025-11-21 14:53:26.391 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [helpdesk].[CatalogItems] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:53:26.405 -06:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [catalog].[Catalogs] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:53:26.475 -06:00 [INF] Executed DbCommand (12ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 500), @p2='?' (DbType = Int32), @p3='?' (Size = 100), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime2), @p6='?' (Size = 200), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (DbType = Int32), @p10='?' (Size = 100), @p11='?' (DbType = Int32), @p12='?' (DbType = DateTime2), @p13='?' (Size = 200), @p14='?' (DbType = DateTime2), @p15='?' (Size = 500), @p16='?' (DbType = Int32), @p17='?' (Size = 100), @p18='?' (DbType = Int32), @p19='?' (DbType = DateTime2), @p20='?' (Size = 200), @p21='?' (DbType = DateTime2), @p22='?' (Size = 500), @p23='?' (DbType = Int32), @p24='?' (Size = 100), @p25='?' (DbType = Int32), @p26='?' (DbType = DateTime2), @p27='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [catalog].[Catalogs] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, 0),
(@p7, @p8, @p9, @p10, @p11, @p12, @p13, 1),
(@p14, @p15, @p16, @p17, @p18, @p19, @p20, 2),
(@p21, @p22, @p23, @p24, @p25, @p26, @p27, 3)) AS i ([CreatedAt], [Description], [DisplayOrder], [Name], [ParentId], [UpdatedAt], [Value], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CreatedAt], [Description], [DisplayOrder], [Name], [ParentId], [UpdatedAt], [Value])
VALUES (i.[CreatedAt], i.[Description], i.[DisplayOrder], i.[Name], i.[ParentId], i.[UpdatedAt], i.[Value])
OUTPUT INSERTED.[Id], INSERTED.[IsActive], i._Position;
2025-11-21 14:53:26.530 -06:00 [INF] Executed DbCommand (19ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 500), @p2='?' (DbType = Int32), @p3='?' (Size = 100), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime2), @p6='?' (Size = 200), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (DbType = Int32), @p10='?' (Size = 100), @p11='?' (DbType = Int32), @p12='?' (DbType = DateTime2), @p13='?' (Size = 200), @p14='?' (DbType = DateTime2), @p15='?' (Size = 500), @p16='?' (DbType = Int32), @p17='?' (Size = 100), @p18='?' (DbType = Int32), @p19='?' (DbType = DateTime2), @p20='?' (Size = 200), @p21='?' (DbType = DateTime2), @p22='?' (Size = 500), @p23='?' (DbType = Int32), @p24='?' (Size = 100), @p25='?' (DbType = Int32), @p26='?' (DbType = DateTime2), @p27='?' (Size = 200), @p28='?' (DbType = DateTime2), @p29='?' (Size = 500), @p30='?' (DbType = Int32), @p31='?' (Size = 100), @p32='?' (DbType = Int32), @p33='?' (DbType = DateTime2), @p34='?' (Size = 200), @p35='?' (DbType = DateTime2), @p36='?' (Size = 500), @p37='?' (DbType = Int32), @p38='?' (Size = 100), @p39='?' (DbType = Int32), @p40='?' (DbType = DateTime2), @p41='?' (Size = 200), @p42='?' (DbType = DateTime2), @p43='?' (Size = 500), @p44='?' (DbType = Int32), @p45='?' (Size = 100), @p46='?' (DbType = Int32), @p47='?' (DbType = DateTime2), @p48='?' (Size = 200), @p49='?' (DbType = DateTime2), @p50='?' (Size = 500), @p51='?' (DbType = Int32), @p52='?' (Size = 100), @p53='?' (DbType = Int32), @p54='?' (DbType = DateTime2), @p55='?' (Size = 200), @p56='?' (DbType = DateTime2), @p57='?' (Size = 500), @p58='?' (DbType = Int32), @p59='?' (Size = 100), @p60='?' (DbType = Int32), @p61='?' (DbType = DateTime2), @p62='?' (Size = 200), @p63='?' (DbType = DateTime2), @p64='?' (Size = 500), @p65='?' (DbType = Int32), @p66='?' (Size = 100), @p67='?' (DbType = Int32), @p68='?' (DbType = DateTime2), @p69='?' (Size = 200), @p70='?' (DbType = DateTime2), @p71='?' (Size = 500), @p72='?' (DbType = Int32), @p73='?' (Size = 100), @p74='?' (DbType = Int32), @p75='?' (DbType = DateTime2), @p76='?' (Size = 200), @p77='?' (DbType = DateTime2), @p78='?' (Size = 500), @p79='?' (DbType = Int32), @p80='?' (Size = 100), @p81='?' (DbType = Int32), @p82='?' (DbType = DateTime2), @p83='?' (Size = 200), @p84='?' (DbType = DateTime2), @p85='?' (Size = 500), @p86='?' (DbType = Int32), @p87='?' (Size = 100), @p88='?' (DbType = Int32), @p89='?' (DbType = DateTime2), @p90='?' (Size = 200), @p91='?' (DbType = DateTime2), @p92='?' (Size = 500), @p93='?' (DbType = Int32), @p94='?' (Size = 100), @p95='?' (DbType = Int32), @p96='?' (DbType = DateTime2), @p97='?' (Size = 200), @p98='?' (DbType = DateTime2), @p99='?' (Size = 500), @p100='?' (DbType = Int32), @p101='?' (Size = 100), @p102='?' (DbType = Int32), @p103='?' (DbType = DateTime2), @p104='?' (Size = 200), @p105='?' (DbType = DateTime2), @p106='?' (Size = 500), @p107='?' (DbType = Int32), @p108='?' (Size = 100), @p109='?' (DbType = Int32), @p110='?' (DbType = DateTime2), @p111='?' (Size = 200), @p112='?' (DbType = DateTime2), @p113='?' (Size = 500), @p114='?' (DbType = Int32), @p115='?' (Size = 100), @p116='?' (DbType = Int32), @p117='?' (DbType = DateTime2), @p118='?' (Size = 200), @p119='?' (DbType = DateTime2), @p120='?' (Size = 500), @p121='?' (DbType = Int32), @p122='?' (Size = 100), @p123='?' (DbType = Int32), @p124='?' (DbType = DateTime2), @p125='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [catalog].[Catalogs] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, 0),
(@p7, @p8, @p9, @p10, @p11, @p12, @p13, 1),
(@p14, @p15, @p16, @p17, @p18, @p19, @p20, 2),
(@p21, @p22, @p23, @p24, @p25, @p26, @p27, 3),
(@p28, @p29, @p30, @p31, @p32, @p33, @p34, 4),
(@p35, @p36, @p37, @p38, @p39, @p40, @p41, 5),
(@p42, @p43, @p44, @p45, @p46, @p47, @p48, 6),
(@p49, @p50, @p51, @p52, @p53, @p54, @p55, 7),
(@p56, @p57, @p58, @p59, @p60, @p61, @p62, 8),
(@p63, @p64, @p65, @p66, @p67, @p68, @p69, 9),
(@p70, @p71, @p72, @p73, @p74, @p75, @p76, 10),
(@p77, @p78, @p79, @p80, @p81, @p82, @p83, 11),
(@p84, @p85, @p86, @p87, @p88, @p89, @p90, 12),
(@p91, @p92, @p93, @p94, @p95, @p96, @p97, 13),
(@p98, @p99, @p100, @p101, @p102, @p103, @p104, 14),
(@p105, @p106, @p107, @p108, @p109, @p110, @p111, 15),
(@p112, @p113, @p114, @p115, @p116, @p117, @p118, 16),
(@p119, @p120, @p121, @p122, @p123, @p124, @p125, 17)) AS i ([CreatedAt], [Description], [DisplayOrder], [Name], [ParentId], [UpdatedAt], [Value], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CreatedAt], [Description], [DisplayOrder], [Name], [ParentId], [UpdatedAt], [Value])
VALUES (i.[CreatedAt], i.[Description], i.[DisplayOrder], i.[Name], i.[ParentId], i.[UpdatedAt], i.[Value])
OUTPUT INSERTED.[Id], INSERTED.[IsActive], i._Position;
2025-11-21 14:53:26.550 -06:00 [INF] HelpDesk API started successfully
2025-11-21 14:53:26.645 -06:00 [INF] Now listening on: http://localhost:5021
2025-11-21 14:53:26.649 -06:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-21 14:53:26.654 -06:00 [INF] Hosting environment: Development
2025-11-21 14:53:26.657 -06:00 [INF] Content root path: D:\REPOSITORY\HelpDesk\HelpDesk.API
2025-11-21 14:55:24.845 -06:00 [INF] Application is shutting down...
2025-11-21 14:59:24.226 -06:00 [INF] Starting HelpDesk API
2025-11-21 14:59:24.864 -06:00 [INF] User profile is available. Using 'C:\Users\marvin.gonzalez\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-21 14:59:26.210 -06:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-21 14:59:26.229 -06:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-21 14:59:26.260 -06:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-21 14:59:26.377 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-21 14:59:26.399 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-21 14:59:26.406 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-21 14:59:26.417 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-21 14:59:26.434 -06:00 [INF] No migrations were applied. The database is already up to date.
2025-11-21 14:59:26.441 -06:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-21 14:59:26.770 -06:00 [INF] Executed DbCommand (15ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0
2025-11-21 14:59:26.825 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0
2025-11-21 14:59:26.831 -06:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0
2025-11-21 14:59:26.869 -06:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[Roles] AS [r]
        WHERE [r].[Name] = N'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:59:26.894 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[Roles] AS [r]
        WHERE [r].[Name] = N'Support') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:59:26.913 -06:00 [INF] Executed DbCommand (8ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Admin' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:59:26.922 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Admin' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:59:26.929 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Admin' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:59:26.939 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Admin' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:59:26.946 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Admin' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:59:26.954 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Admin' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:59:26.965 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Support' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:59:26.974 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Support' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:59:26.980 -06:00 [INF] Executed DbCommand (0ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Support' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:59:27.023 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [security].[Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-21 14:59:27.077 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedRoleName_0
2025-11-21 14:59:27.114 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[RoleId]
FROM [security].[UserRoles] AS [u]
WHERE [u].[UserId] = @__p_0 AND [u].[RoleId] = @__p_1
2025-11-21 14:59:27.134 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [helpdesk].[CatalogItems] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:59:27.146 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [catalog].[Catalogs] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 14:59:27.156 -06:00 [INF] HelpDesk API started successfully
2025-11-21 14:59:27.228 -06:00 [INF] Now listening on: http://localhost:5021
2025-11-21 14:59:27.233 -06:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-21 14:59:27.236 -06:00 [INF] Hosting environment: Development
2025-11-21 14:59:27.238 -06:00 [INF] Content root path: D:\REPOSITORY\HelpDesk\HelpDesk.API
2025-11-21 15:04:38.218 -06:00 [INF] Application is shutting down...
2025-11-21 15:05:58.655 -06:00 [INF] Starting HelpDesk API
2025-11-21 15:05:59.229 -06:00 [INF] User profile is available. Using 'C:\Users\marvin.gonzalez\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-21 15:06:00.369 -06:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-21 15:06:00.391 -06:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-21 15:06:00.420 -06:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-21 15:06:00.505 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-21 15:06:00.529 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-21 15:06:00.535 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-21 15:06:00.545 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-21 15:06:00.567 -06:00 [INF] No migrations were applied. The database is already up to date.
2025-11-21 15:06:00.574 -06:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-21 15:06:01.014 -06:00 [INF] Executed DbCommand (15ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0
2025-11-21 15:06:01.081 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0
2025-11-21 15:06:01.089 -06:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0
2025-11-21 15:06:01.121 -06:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[Roles] AS [r]
        WHERE [r].[Name] = N'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:06:01.146 -06:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[Roles] AS [r]
        WHERE [r].[Name] = N'Support') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:06:01.160 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Admin' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:06:01.167 -06:00 [INF] Executed DbCommand (0ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Admin' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:06:01.173 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Admin' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:06:01.179 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Admin' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:06:01.186 -06:00 [INF] Executed DbCommand (0ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Admin' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:06:01.192 -06:00 [INF] Executed DbCommand (0ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Admin' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:06:01.200 -06:00 [INF] Executed DbCommand (0ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Admin' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:06:01.247 -06:00 [INF] Executed DbCommand (3ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Support' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:06:01.254 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Support' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:06:01.260 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Support' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:06:01.269 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Support' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:06:01.369 -06:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Size = 100), @p1='?' (Size = 256), @p2='?' (Size = 100), @p3='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [security].[RolePermissions] USING (
VALUES (@p0, @p1, 0),
(@p2, @p3, 1)) AS i ([Permission], [RoleName], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([Permission], [RoleName])
VALUES (i.[Permission], i.[RoleName])
OUTPUT INSERTED.[Id], i._Position;
2025-11-21 15:06:01.409 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [security].[Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-21 15:06:01.460 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedRoleName_0
2025-11-21 15:06:01.518 -06:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[RoleId]
FROM [security].[UserRoles] AS [u]
WHERE [u].[UserId] = @__p_0 AND [u].[RoleId] = @__p_1
2025-11-21 15:06:01.544 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [helpdesk].[CatalogItems] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:06:01.559 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [catalog].[Catalogs] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:06:01.570 -06:00 [INF] HelpDesk API started successfully
2025-11-21 15:06:01.650 -06:00 [INF] Now listening on: http://localhost:5021
2025-11-21 15:06:01.655 -06:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-21 15:06:01.657 -06:00 [INF] Hosting environment: Development
2025-11-21 15:06:01.658 -06:00 [INF] Content root path: D:\REPOSITORY\HelpDesk\HelpDesk.API
2025-11-21 15:14:35.564 -06:00 [INF] Application is shutting down...
2025-11-21 15:16:49.865 -06:00 [INF] Starting HelpDesk API
2025-11-21 15:16:50.677 -06:00 [INF] User profile is available. Using 'C:\Users\marvin.gonzalez\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-21 15:16:52.154 -06:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-21 15:16:52.174 -06:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-21 15:16:52.209 -06:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-21 15:16:52.288 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-21 15:16:52.312 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-21 15:16:52.320 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-21 15:16:52.330 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-21 15:16:52.354 -06:00 [INF] No migrations were applied. The database is already up to date.
2025-11-21 15:16:52.360 -06:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-21 15:16:52.719 -06:00 [INF] Executed DbCommand (15ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0
2025-11-21 15:16:52.775 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0
2025-11-21 15:16:52.781 -06:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0
2025-11-21 15:16:52.807 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[Roles] AS [r]
        WHERE [r].[Name] = N'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:16:52.819 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[Roles] AS [r]
        WHERE [r].[Name] = N'Support') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:16:52.831 -06:00 [INF] Executed DbCommand (3ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Admin' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:16:52.838 -06:00 [INF] Executed DbCommand (0ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Admin' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:16:52.844 -06:00 [INF] Executed DbCommand (0ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Admin' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:16:52.851 -06:00 [INF] Executed DbCommand (0ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Admin' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:16:52.870 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Admin' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:16:52.876 -06:00 [INF] Executed DbCommand (0ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Admin' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:16:52.881 -06:00 [INF] Executed DbCommand (0ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Admin' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:16:52.893 -06:00 [INF] Executed DbCommand (3ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Support' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:16:52.900 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Support' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:16:52.905 -06:00 [INF] Executed DbCommand (0ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Support' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:16:52.910 -06:00 [INF] Executed DbCommand (0ms) [Parameters=[@__permission_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [security].[RolePermissions] AS [r]
        WHERE [r].[RoleName] = N'Support' AND [r].[Permission] = @__permission_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:16:52.946 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [security].[Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-21 15:16:53.003 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [security].[Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedRoleName_0
2025-11-21 15:16:53.047 -06:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[RoleId]
FROM [security].[UserRoles] AS [u]
WHERE [u].[UserId] = @__p_0 AND [u].[RoleId] = @__p_1
2025-11-21 15:16:53.075 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [helpdesk].[CatalogItems] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:16:53.087 -06:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [catalog].[Catalogs] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-21 15:16:53.098 -06:00 [INF] HelpDesk API started successfully
2025-11-21 15:16:53.167 -06:00 [INF] Now listening on: http://localhost:5021
2025-11-21 15:16:53.172 -06:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-21 15:16:53.174 -06:00 [INF] Hosting environment: Development
2025-11-21 15:16:53.176 -06:00 [INF] Content root path: D:\REPOSITORY\HelpDesk\HelpDesk.API
